<ng-container *ngIf="entity">
  <ng-template [ngTemplateOutlet]="avatar"></ng-template>
  <div class="m-suggestedPanelCard__bodyContainer" #bodyContainer>
    <span class="m-suggestedPanelCard__name" routerLink="['/' + username]">
      {{ name }}
    </span>
    <span class="m-suggestedPanelCard__description">
      {{ description }}
    </span>
    <div
      *ngIf="hovering$ | async"
      class="m-suggestedPanelCard__hoverCardContainer"
    >
      <!-- Hover card -->
      <div class="m-hoverCard__topbar">
        <ng-template [ngTemplateOutlet]="avatar"></ng-template>
        <div class="m-hoverCard__namePanel">
          <a
            class="m-suggestedPanelCard__link--undecorated"
            [href]="'/' + username"
            target="_blank"
          >
            <span class="m-hoverCard__name">
              {{ name }}
            </span>
          </a>
          <a
            class="m-suggestedPanelCard__link--undecorated"
            [href]="'/' + username"
            target="_blank"
          >
            <span class="m-hoverCard__username"> @{{ username }} </span>
          </a>
        </div>
        <ng-template [ngTemplateOutlet]="interactButton"></ng-template>
      </div>
      <div class="m-hoverCard__body">
        <div class="m-hoverCard__subCountsContainer">
          <span class="m-hoverCard__subscriberCount--primary">{{
            subscribersCount
          }}</span>
          <span class="m-hoverCard__subscriberCount--secondary">
            subscribers Â·
          </span>
          <span class="m-hoverCard__subscriberCount--primary">{{
            subscriptionsCount
          }}</span>
          <span class="m-hoverCard__subscriberCount--secondary">
            subscriptions</span
          >
        </div>
        <div class="m-hoverCard__hashtagsContainer">
          <a
            *ngFor="let hashtag of hashtags"
            class="m-suggestedPanelCard__link--undecorated"
            [href]="'/discovery/search?f=top&t=all&q=%23' + hashtag"
            target="_blank"
            >#{{ hashtag }}
          </a>
        </div>
        <span class="m-hoverCard__description">{{ description }}</span>
      </div>
    </div>
  </div>
  <ng-template [ngTemplateOutlet]="interactButton"></ng-template>
</ng-container>

<ng-template #interactButton>
  <div class="m-suggestedPanelCard__subscribeButtonContainer">
    <div
      class="m-suggestedPanelCard__subscribeButton"
      (click)="onSubscribeToggle()"
    >
      <!-- + symbol -->
      <i
        *ngIf="!subscribed && !(subscriptionInProgress$ | async)"
        class="material-icons"
        >add</i
      >
      <!-- checkmark symbol -->
      <i
        *ngIf="subscribed && !(subscriptionInProgress$ | async)"
        class="material-icons m-suggestedPanelCard__subscribeButton--subscribed"
        >done</i
      >
      <!-- in progress -->
      <i
        *ngIf="subscriptionInProgress$ | async"
        class="material-icons m-suggestedPanelCard__subscribeButton--subscribed"
        >more_horiz</i
      >
    </div>
  </div>
</ng-template>

<ng-template #avatar>
  <a
    class="m-suggestedPanelCard__avatarContainer"
    [href]="'/' + username"
    target="_blank"
  >
    <img [src]="avatarUrl" class="m-suggestedPanelCard__avatar" />
  </a>
</ng-template>
