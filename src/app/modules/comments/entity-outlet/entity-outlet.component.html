<div class="m-commentsEntityOutlet__topBar" *ngIf="!showOnlyTree && count > 0">
  <div class="m-commentsEntityOutlet__header">
    <span class="m-commentsEntityOutlet__title" (click)="toggleComments()"
      >Comments</span
    >
    <span class="m-commentsEntityOutlet__count" (click)="toggleComments()">{{
      count
    }}</span>
    <span
      class="m-commentsEntityOutlet__addComment"
      (click)="scroll(commentsTree.posterEl)"
      >Add your comment</span
    >
  </div>
  <div *ngIf="false" class="m-commentsEntityOutlet__filter">
    <i class="material-icons">filter_list</i>
  </div>
</div>
<ng-container *ngIf="showOnlyPoster">
  <div
    class="m-commentsEntityOutlet__optimisticList"
    *ngIf="optimisticList.length > 0"
  >
    <ng-container *ngFor="let comment of optimisticList">
      <m-comment
        [comment]="comment"
        [entity]="entity"
        [parent]="parent"
        [level]="0"
        [canEdit]="canEdit"
        [canDelete]="canDelete"
        [showReplies]="comment.show_replies"
        (delete)="delete(i)"
        (saved)="edited(i, $event)"
        (onReply)="reply($event.comment)"
      ></m-comment>
    </ng-container>
  </div>

  <m-comment__poster
    *ngIf="(legacyActivityService.allowComment$ | async) && !showOnlyTree"
    [guid]="guid"
    [parent]="entity"
    [entity]="entity"
    [currentIndex]="0"
    [level]="0"
    (posted)="onPosted($event)"
    (optimisticPost)="onOptimisticPost($event)"
  >
  </m-comment__poster>
</ng-container>
<m-comments__tree
  #commentsTree
  *ngIf="!showOnlyPoster || showOnlyTree"
  [entity]="entity"
  [canDelete]="canDelete"
>
</m-comments__tree>
